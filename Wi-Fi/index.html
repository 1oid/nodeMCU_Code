<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>aa</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

    </style>
    
</head>
<body>
    <button onclick="scanap()">扫描热点</button> <br>

    <select id="ssid">
        <option value ="volvo">Volvo</option>
    </select> <input type="text" name="password" id="password" value="" placeholder="wifi连接密码" /><br>
    <button onclick="submit()">连接wifi</button>

    <script type="text/javascript">
        var ajax={
          get: function(url, fn) {
            // XMLHttpRequest对象用于在后台与服务器交换数据   
            var xhr = new XMLHttpRequest();            
            xhr.open('GET', url, true);
            xhr.onreadystatechange = function() {
              // readyState == 4说明请求已完成
              if (xhr.readyState == 4 && xhr.status == 200 || xhr.status == 304) { 
                // 从服务器获得数据 
                fn.call(this, xhr.responseText);  
              }
            };
            xhr.send();
          },
          
        }

        function scanap() {
            ajax.get("/scanap", function(result) {
                var json_data = JSON.parse(result);
                for(var data in json_data) {
                    getData(data);
                }
            });
        }

        function submit() {
            var current_select_ssid = document.getElementById("ssid");
            var current_select_passowrd = document.getElementById("password");
            var target = "/config?ssid="+current_select_ssid+"&pwd="+current_select_passowrd;
            ajax.get(target, function(result) {
                alert(JSON.parse(result).status);
            });
            // alert(current_select_ssid.value);
        }

        function getData(val) {
            console.log(val);
            var node = document.createElement("option");
            node.value = val;
            node.innerText = val;
            document.getElementById("ssid").appendChild(node);
        }
    </script>
</body>
</html>